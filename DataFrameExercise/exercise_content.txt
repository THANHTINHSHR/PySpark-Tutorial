ğŸ”¥ BÃ i táº­p Spark tá»•ng há»£p: Xá»­ lÃ½ dá»¯ liá»‡u bÃ³ng Ä‘Ã¡
Má»¥c tiÃªu: Thá»±c hÃ nh toÃ n bá»™ kiáº¿n thá»©c Spark gá»“m I/O, Transformations (Narrow, Wide, UDFs, Window), Actions, Caching, SQL, Schema Metadata.

ğŸ“Œ Dá»¯ liá»‡u Ä‘Ã£ cÃ³:
player_raw.csv: ThÃ´ng tin cáº§u thá»§
score_raw.csv: Káº¿t quáº£ tráº­n Ä‘áº¥u
squad_raw.csv: ThÃ´ng tin Ä‘á»™i bÃ³ng
match_raw.csv: Chi tiáº¿t tráº­n Ä‘áº¥u
ğŸ”¹ BÃ i táº­p 1: Äá»c vÃ  kiá»ƒm tra dá»¯ liá»‡u
1ï¸âƒ£ Äá»c dá»¯ liá»‡u tá»« CSV vÃ o DataFrame, Ä‘áº£m báº£o:

CÃ³ header
Tá»± Ä‘á»™ng suy luáº­n schema (inferSchema=True)
Hiá»ƒn thá»‹ 5 dÃ²ng Ä‘áº§u tiÃªn
2ï¸âƒ£ Kiá»ƒm tra metadata cá»§a DataFrame:

In schema (printSchema)
Láº¥y danh sÃ¡ch cá»™t (columns)
Xem kiá»ƒu dá»¯ liá»‡u tá»«ng cá»™t (dtypes)
Xem tÃ³m táº¯t dá»¯ liá»‡u (describe)
ğŸ”¹ BÃ i táº­p 2: Data Cleaning
1ï¸âƒ£ XÃ³a dÃ²ng bá»‹ thiáº¿u dá»¯ liá»‡u
2ï¸âƒ£ Chuáº©n hÃ³a kiá»ƒu dá»¯ liá»‡u (convert sá»‘ vá» Integer, ngÃ y vá» Date,...)
3ï¸âƒ£ Loáº¡i bá» khoáº£ng tráº¯ng dÆ° thá»«a trong tÃªn Ä‘á»™i bÃ³ng, cáº§u thá»§

ğŸ”¹ BÃ i táº­p 3: Narrow Transformations
1ï¸âƒ£ ThÃªm cá»™t má»›i (withColumn)

ThÃªm cá»™t season = 2023-2024 vÃ o táº¥t cáº£ báº£ng
Chuyá»ƒn tÃªn cáº§u thá»§, Ä‘á»™i bÃ³ng thÃ nh chá»¯ IN HOA
2ï¸âƒ£ Filter dá»¯ liá»‡u (filter / where)

Láº¥y danh sÃ¡ch cáº§u thá»§ cÃ³ sá»‘ bÃ n tháº¯ng > 5
Láº¥y danh sÃ¡ch tráº­n Ä‘áº¥u cÃ³ trÃªn 50.000 khÃ¡n giáº£
3ï¸âƒ£ Select vÃ  rename cá»™t (select / alias)

Láº¥y cá»™t name, nation tá»« player_raw.csv vÃ  Ä‘á»•i tÃªn thÃ nh player_name, country
ğŸ”¹ BÃ i táº­p 4: Wide Transformations
1ï¸âƒ£ NhÃ³m vÃ  tá»•ng há»£p dá»¯ liá»‡u (groupBy + agg)

TÃ­nh tá»•ng sá»‘ bÃ n tháº¯ng cá»§a tá»«ng Ä‘á»™i bÃ³ng
Äáº¿m sá»‘ tráº­n Ä‘áº¥u cá»§a tá»«ng Ä‘á»™i
2ï¸âƒ£ Join dá»¯ liá»‡u (join)

Káº¿t há»£p match_raw vá»›i score_raw dá»±a trÃªn match_id
Káº¿t há»£p player_raw vá»›i squad_raw Ä‘á»ƒ biáº¿t tá»«ng cáº§u thá»§ thuá»™c Ä‘á»™i nÃ o
ğŸ”¹ BÃ i táº­p 5: UDFs (User Defined Functions)
1ï¸âƒ£ Viáº¿t UDF chuyá»ƒn Ä‘á»•i tÃªn quá»‘c gia tá»« viáº¿t táº¯t (ENG â†’ England, FRA â†’ France)
2ï¸âƒ£ Viáº¿t UDF phÃ¢n loáº¡i cáº§u thá»§ theo sá»‘ bÃ n tháº¯ng:

>= 10 â†’ "SiÃªu sao"
5-9 â†’ "Trung bÃ¬nh"
<5 â†’ "Dá»± bá»‹"
ğŸ”¹ BÃ i táº­p 6: Window Functions
1ï¸âƒ£ Xáº¿p háº¡ng cáº§u thá»§ theo sá»‘ bÃ n tháº¯ng trong má»—i Ä‘á»™i (rank())
2ï¸âƒ£ TÃ­nh tá»•ng sá»‘ bÃ n tháº¯ng cá»§a tá»«ng Ä‘á»™i qua cÃ¡c vÃ²ng Ä‘áº¥u (sum() + partitionBy)

ğŸ”¹ BÃ i táº­p 7: SQL Operations
1ï¸âƒ£ ÄÄƒng kÃ½ táº¥t cáº£ DataFrame thÃ nh báº£ng SQL (createOrReplaceTempView)
2ï¸âƒ£ Viáº¿t truy váº¥n SQL:

Láº¥y danh sÃ¡ch cáº§u thá»§ cÃ³ sá»‘ bÃ n tháº¯ng cao nháº¥t
Láº¥y 5 Ä‘á»™i cÃ³ sá»‘ tráº­n tháº¯ng nhiá»u nháº¥t
TÃ­nh sá»‘ tráº­n Ä‘áº¥u trung bÃ¬nh má»—i Ä‘á»™i tham gia
ğŸ”¹ BÃ i táº­p 8: Caching & Optimization
1ï¸âƒ£ Cache DataFrame lá»›n vÃ  Ä‘o thá»i gian truy váº¥n trÆ°á»›c/sau khi cache
2ï¸âƒ£ DÃ¹ng broadcast join Ä‘á»ƒ tá»‘i Æ°u join giá»¯a báº£ng nhá» (player_raw) vÃ  báº£ng lá»›n (match_raw)

ğŸ“Œ CÃ¡ch lÃ m & LÆ°u Ã½
âœ… Táº¡o file Python tÆ°Æ¡ng á»©ng (spark_reader.py, spark_transform.py, spark_sql.py...)
âœ… Cháº¡y thá»­ tá»«ng pháº§n, kiá»ƒm tra káº¿t quáº£
âœ… Log thá»i gian cháº¡y Ä‘á»ƒ so sÃ¡nh hiá»‡u suáº¥t (time.time())

